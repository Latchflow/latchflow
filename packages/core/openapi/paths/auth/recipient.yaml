recipient_start:
  post:
    summary: Start recipient OTP flow
    operationId: startRecipientOtp
    tags: [Auth (Recipient)]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            oneOf:
              - type: object
                properties:
                  recipientId: { type: string }
                required: [recipientId]
              - type: object
                properties:
                  email: { type: string, format: email }
                required: [email]
          examples:
            "recipient ID":
              value:
                recipientId: 11111111-1111-1111-1111-111111111111
            email:
              value:
                email: recipient@example.com
    responses:
      '204':
        description: OTP issued (dev logs only)
      '404':
        $ref: ../../components/responses/NotFound.yaml
      '429':
        $ref: ../../components/responses/RateLimited.yaml
      '400':
        $ref: ../../components/responses/ValidationError.yaml

recipient_verify:
  post:
    summary: Verify recipient OTP and establish session
    operationId: verifyRecipientOtp
    tags: [Auth (Recipient)]
    requestBody:
      required: true
      content:
        application/json:
          schema:
            allOf:
              - oneOf:
                  - type: object
                    properties:
                      recipientId: { type: string }
                    required: [recipientId]
                  - type: object
                    properties:
                      email: { type: string, format: email }
                    required: [email]
              - type: object
                properties:
                  otp: { type: string }
                required: [otp]
          examples:
            example:
              value:
                recipientId: 11111111-1111-1111-1111-111111111111
                otp: "123456"
            example_by_email:
              value:
                email: recipient@example.com
                otp: "123456"
    responses:
      '204':
        description: Session established via cookie
      '401':
        $ref: ../../components/responses/Unauthorized.yaml
      '429':
        $ref: ../../components/responses/RateLimited.yaml
      '400':
        $ref: ../../components/responses/ValidationError.yaml

recipient_logout:
  post:
    summary: Logout recipient session
    operationId: logoutRecipient
    tags: [Auth (Recipient)]
    responses:
      '204':
        description: Logged out
