# Default environment variable configurartion
# To override these values, create a .env file in the same directory
# and set the variables there.

# Database
DB_USER=latchflow
DB_PASSWORD=latchflow
DB_HOST=host.docker.internal
DB_NAME=latchflow
DATABASE_URL=postgres://${DB_USER}:${DB_PASSWORD}@${DB_HOST}/${DB_NAME}

# Core
PORT=3001
PLUGINS_PATH="../plugins"

# Logging
LOG_LEVEL=info
LOG_PRETTY=true

# SMTP
SMTP_URL=smtp://localhost:1025 # Use host.docker.internal:1025 if dev container
SMTP_FROM=no-reply@test.local

# Queue
QUEUE_DRIVER=memory
# QUEUE_DRIVER_PATH=
# QUEUE_CONFIG_JSON=

# Storage
# Default to filesystem for local development
STORAGE_DRIVER=fs
STORAGE_BASE_PATH="./.data/storage"
STORAGE_BUCKET=latchflow-dev
STORAGE_KEY_PREFIX=
# To use S3-compatible storage (MinIO), set:
# STORAGE_DRIVER=s3
# For host-local dev (Core running on host):
STORAGE_CONFIG_JSON='{"region":"us-east-1","endpoint":"http://localhost:9000","presignEndpoint":"http://localhost:9000","forcePathStyle":true,"accessKeyId":"minioadmin","secretAccessKey":"minioadmin","ensureBucket":true}'
# For dev containers: override endpoint to Docker network hostname while keeping presignEndpoint for browser/Postman
# STORAGE_CONFIG_JSON='{"region":"us-east-1","endpoint":"http://minio:9000","presignEndpoint":"http://localhost:9000","forcePathStyle":true,"accessKeyId":"minioadmin","secretAccessKey":"minioadmin","ensureBucket":true}'
# STORAGE_DRIVER_PATH=

# Encryption
ENCRYPTION_MODE=none
# ENCRYPTION_MASTER_KEY_B64=

# Auth
AUTH_SESSION_TTL_HOURS=12
RECIPIENT_SESSION_TTL_HOURS=2
ADMIN_MAGICLINK_TTL_MIN=15
RECIPIENT_OTP_TTL_MIN=10
RECIPIENT_OTP_LENGTH=6
# AUTH_COOKIE_SECURE is auto-defaulted to 'false' in development and 'true' otherwise
# AUTH_COOKIE_SECURE=true
# ADMIN_UI_ORIGIN=http://localhost:3000
# Dev-only: return login_url from /auth/admin/start instead of sending email
# ALLOW_DEV_AUTH=true

# CLI auth
DEVICE_CODE_TTL_MIN=10
DEVICE_CODE_INTERVAL_SEC=5
# API_TOKEN_TTL_DAYS=
API_TOKEN_SCOPES_DEFAULT='["core:read","core:write"]'
API_TOKEN_PREFIX=lfk_

# History / audit
HISTORY_SNAPSHOT_INTERVAL=20
HISTORY_MAX_CHAIN_DEPTH=200
SYSTEM_USER_ID=system

# MinIO (S3-compatible) defaults for docker-compose
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# Authorization v2
AUTHZ_V2=true
AUTHZ_V2_SHADOW=false

# OpenTelemetry / Metrics
AUTHZ_METRICS_ENABLED=false
AUTHZ_METRICS_OTLP_URL=http://host.docker.internal:4318/v1/metrics
AUTHZ_METRICS_SERVICE_NAME=latchflow-core
AUTHZ_METRICS_EXPORT_INTERVAL_MS=15000
AUTHZ_METRICS_EXPORT_TIMEOUT_MS=10000
AUTHZ_METRICS_ENABLE_DIAGNOSTICS=true
